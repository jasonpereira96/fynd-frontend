(this["webpackJsonpfynd-frontend"]=this["webpackJsonpfynd-frontend"]||[]).push([[0],{125:function(e,t,a){e.exports=a(154)},130:function(e,t,a){},131:function(e,t,a){},154:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(12),o=a.n(i),l=(a(130),a(131),a(73)),s=a(16),c=a(61),d=a(46),u=a(55),m=a(38),p=a(39),h=a(15),f=a(51),v=a(50),g=a(76),b=a(155),y=a(43),E=a(8),w=a(208),k=a(200),S=a(206),O=a(202),j=a(199),C=a(205),F=function(e){var t,a=e.value;return a?Array.isArray(a)?Array.isArray(a)&&(t=a):t=a.split(", "):t=[],t.map((function(e,t){return r.a.createElement(w.a,{label:e,key:t})}))};function D(e){var t=e.value,a=e.onValueChange;t?Array.isArray(t)||(t=t.split(", ")):t=[];var n=new Set(t),i=this.props.genres;return r.a.createElement(S.a,{input:r.a.createElement(k.a,null),value:t,onChange:function(e){return a(e.target.value)},multiple:!0,style:{width:"100%"},renderValue:function(e){return e.join(", ")}},i.map((function(e){return r.a.createElement(O.a,{key:e.id,value:e.name},r.a.createElement(C.a,{checked:n.has(e.name)}),r.a.createElement(j.a,{primary:e.name}))})))}function I(e){var t=e.grid;return r.a.createElement(E.b,Object.assign({formatterComponent:F.bind(t),editorComponent:D.bind(t)},e))}var N=["genres"],R=function(e){Object(f.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).state={lastQuery:"",loading:!1,rows:[],filters:[]},n.setLoading=n.setLoading.bind(Object(h.a)(n)),n.setLastQuery=n.setLastQuery.bind(Object(h.a)(n)),n.setFilters=n.setFilters.bind(Object(h.a)(n)),n.setRows=n.setRows.bind(Object(h.a)(n)),n.setLoading=n.setLoading.bind(Object(h.a)(n)),n.setLastQuery=n.setLastQuery.bind(Object(h.a)(n)),n.getCommitChanges=n.getCommitChanges.bind(Object(h.a)(n)),n.onDataEdit=n.onDataEdit.bind(Object(h.a)(n)),n}return Object(p.a)(a,[{key:"render",value:function(){var e,t=this.props,a=t.isAdmin,n=t.verified,i=(r.a.Fragment,r.a.createElement(r.a.Fragment,null)),o=r.a.createElement(r.a.Fragment,null),l=r.a.createElement(r.a.Fragment,null);e=[{name:"id",title:"ID"},{name:"name",title:"Name"},{name:"director",title:"Director"},{name:"genres",title:"Genres"},{name:"imdb_score",title:"IMDB Score"},{name:"popularity",title:"Popularity"}];if(a&&(o=r.a.createElement(y.d,null),l=r.a.createElement(y.c,{showAddCommand:!1,showEditCommand:!0,showDeleteCommand:!0}),i=r.a.createElement(E.d,{onCommitChanges:this.onDataEdit,getRowId:function(e){return e.id},columnExtensions:[{columnName:"name",editingEnabled:!1},{columnName:"id",editingEnabled:!1}]})),a)if(n)s=this.props.data;else s=[];else var s=this.props.data;return r.a.createElement("div",{className:"datagrid"},r.a.createElement(b.a,null,r.a.createElement(y.a,{rows:s,columns:e},r.a.createElement(I,{for:N,grid:this}),i,r.a.createElement(E.l,{defaultSorting:[{columnName:"id",direction:"asc"}]}),r.a.createElement(E.i,null),r.a.createElement(y.b,null),r.a.createElement(y.f,{columnExtensions:[{columnName:"genres",wordWrapEnabled:!0}]}),r.a.createElement(y.e,{showSortingControls:!0}),o,l)))}},{key:"setLastQuery",value:function(e){this.setState({lastQuery:e})}},{key:"setLoading",value:function(e){this.setState({loading:e})}},{key:"setRows",value:function(e){this.setState({rows:e})}},{key:"setFilters",value:function(e){this.setState({filters:e})}},{key:"onDataEdit",value:function(e){if(e.deleted)for(var t=0;t<e.deleted.length;t++){var a=e.deleted[t];e.deleted[t]=this.props.data[a].id}if(e.changed){for(var n={},r=0,i=Object.keys(e.changed);r<i.length;r++){var o=i[r],l=parseInt(o),s=this.props.data[l].id;void 0!==e.changed[o]&&(n[s]=e.changed[o])}e.changed=n}this.props.onDataEdit(e)}},{key:"getCommitChanges",value:function(){var e=this.setRows,t=this.state.rows;return function(a){var n,r=a.added,i=a.changed,o=a.deleted;if(r){var l=t.length>0?t[t.length-1].id+1:0;n=[].concat(Object(c.a)(t),Object(c.a)(r.map((function(e,t){return Object(g.a)({id:l+t},e)}))))}if(i&&(n=t.map((function(e){return i[e.id]?Object(g.a)(Object(g.a)({},e),i[e.id]):e}))),o){var s=new Set(o);n=t.filter((function(e){return!s.has(e.id)}))}e(n)}}}]),a}(r.a.Component),P=a(204),A=Object(P.a)((function(e){return{root:{display:"flex",justifyContent:"center",flexWrap:"wrap",listStyle:"none",padding:e.spacing(.5),margin:0},chip:{margin:e.spacing(.5)}}}));function L(e){var t=A(),a=e.chipsFilters;return r.a.createElement(b.a,{component:"ul",className:t.root},a.map((function(a){return r.a.createElement("li",{key:a.key},r.a.createElement(w.a,{label:a.value,className:t.chip,onClick:(n=a,function(){console.log(n),e.chipClicked(n)}),color:a.applied?"primary":"secondary"}));var n})))}var G=a(207),B=a(203),_=a(77),U=a(158);function x(){return{top:"".concat(50,"%"),left:"".concat(50,"%"),transform:"translate(-".concat(50,"%, -").concat(50,"%)")}}var K=Object(P.a)((function(e){return{paper:{position:"absolute",width:400,backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}}));function T(e){var t=K(),a=r.a.useState(x),n=Object(u.a)(a,1)[0],i=r.a.useState(!1),o=Object(u.a)(i,2),l=o[0],s=o[1],c=r.a.useState([]),d=Object(u.a)(c,2),m=d[0],p=d[1],h=r.a.createRef(),f=r.a.createRef(),v=r.a.createRef(),g=r.a.createRef(),b=r.a.createRef();var y=e.chipsFilters.map((function(e){return e.value})),E=r.a.createElement("div",{style:n,className:t.paper},r.a.createElement("h2",{id:"simple-modal-title"},"New Row"),r.a.createElement("form",{className:t.root,autoComplete:"off",id:"row-form"},r.a.createElement(G.a,{id:"outlined-name",label:"Name",variant:"outlined",required:!0,placeholder:"Name",ref:h}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(G.a,{id:"outlined-director",label:"Director",variant:"outlined",required:!0,placeholder:"Director",ref:f}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(G.a,{id:"outlined-imdb-score",label:"IMDB Score",variant:"outlined",required:!0,placeholder:"IMDB Score",type:"number",ref:v,inputProps:{step:"any"}}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(G.a,{id:"outlined-popularity",label:"Popularity",variant:"outlined",required:!0,placeholder:"Popularity",type:"number",ref:g}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(S.a,{multiple:!0,value:m,label:"Genre",input:r.a.createElement(k.a,{id:"outlined-genres"}),variant:"outlined",required:!0,placeholder:"Genre",renderValue:function(e){return e.join(", ")},onChange:function(e){p(e.target.value)},ref:b},y.map((function(e){return r.a.createElement(O.a,{key:e,value:e},r.a.createElement(C.a,{checked:m.includes(e)}),e)}))),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(B.a,{type:"button",variant:"contained",color:"primary",onClick:function(){var t=document.getElementById("row-form");if(t.checkValidity()){var a=document.getElementById("outlined-name"),n=document.getElementById("outlined-director"),r=document.getElementById("outlined-imdb-score"),i=document.getElementById("outlined-popularity"),o=document.getElementById("outlined-genres");e.onRowSubmit({name:a.value,director:n.value,imdb_score:parseFloat(r.value),popularity:parseFloat(i.value),genres:o.value.split(",")}),s(!1)}else t.reportValidity()}},"Add")));return r.a.createElement("div",null,r.a.createElement(B.a,{onClick:function(){s(!0)},color:"primary",variant:"contained"},"New Record"),r.a.createElement(U.a,{open:l,onClose:function(){s(!1)},"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description"},E))}var Q={showError:function(e){console.log(e)}},J=function(e){Object(f.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).onPasswordSubmit=n.onPasswordSubmit.bind(Object(h.a)(n)),n.onPasswordKeyPress=n.onPasswordKeyPress.bind(Object(h.a)(n)),n.onGenreSubmit=n.onGenreSubmit.bind(Object(h.a)(n)),n.onRowSubmit=n.onRowSubmit.bind(Object(h.a)(n)),n.handleClose=n.handleClose.bind(Object(h.a)(n)),n.state={modalOpen:!1},n}return Object(p.a)(a,[{key:"render",value:function(){var e=this,t=this.props.onSearch,a=this.props.isAdmin;this.props.verified;if(a)var n=r.a.createElement("div",{id:"admin-button-div"}),i=r.a.createElement(r.a.Fragment,null,r.a.createElement(G.a,{type:"text",id:"username-input",placeholder:"Username"}),"\xa0 \xa0",r.a.createElement(G.a,{type:"password",id:"password-input",placeholder:"Password",onKeyPress:function(t){return e.onPasswordKeyPress(t)}}),"\xa0 \xa0 \xa0 \xa0",r.a.createElement(B.a,{color:"primary",variant:"contained",onClick:this.onPasswordSubmit},"Go"));else n=r.a.createElement("div",{id:"admin-button-div"},r.a.createElement(B.a,{color:"primary",variant:"contained"},r.a.createElement(l.b,{to:"/admin"},"Admin Panel"))),i=r.a.createElement("div",null);return r.a.createElement("div",{className:"main-header"},r.a.createElement("div",{className:"heading"},r.a.createElement("div",null),r.a.createElement("div",null,r.a.createElement(_.a,{variant:"h3",gutterBottom:!0},"Movies Database")),n),r.a.createElement("div",null,i),r.a.createElement("br",null),r.a.createElement(G.a,{type:"text",id:"search-input",onChange:function(e,a){t(e,e.target.value+"")},placeholder:"Search..."}),r.a.createElement(L,{chipClicked:this.props.chipClicked,chipsFilters:this.props.chipsFilters}),this.getProtectedInputs())}},{key:"onPasswordSubmit",value:function(){var e=document.getElementById("username-input").value,t=document.getElementById("password-input").value;this.props.onPasswordSubmit(e,t)}},{key:"onGenreSubmit",value:function(){var e=document.getElementById("genre-input").value;e.length>0?this.props.onGenreSubmit(e):Q.showError("genre cannot be empty")}},{key:"onPasswordKeyPress",value:function(e){"Enter"===e.key&&this.onPasswordSubmit()}},{key:"getProtectedInputs",value:function(){var e=this.props,t=e.verified,a=e.chipsFilters;return t?r.a.createElement(r.a.Fragment,null,r.a.createElement("br",null),r.a.createElement(G.a,{type:"text",placeholder:"Add Genre",inputProps:{id:"genre-input"}}),"\xa0 \xa0 \xa0 \xa0",r.a.createElement(B.a,{color:"primary",variant:"contained",onClick:this.onGenreSubmit},"Add Genre"),"\xa0 \xa0 \xa0 \xa0",r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(T,{chipsFilters:a,onRowSubmit:this.onRowSubmit})):r.a.createElement(r.a.Fragment,null)}},{key:"onRowSubmit",value:function(e){console.log("row submitted"),console.log(e);var t={added:[e]};this.props.onDataEdit(t)}},{key:"handleClose",value:function(){this.setState({modalOpen:!1})}}]),a}(r.a.Component),M=a(44),q=a.n(M),V="aba102da-f581-4ff7-a350-b7b671f70e68",W=function(){function e(){Object(m.a)(this,e),this.URL="https://fynd-app.herokuapp.com"}return Object(p.a)(e,[{key:"getData",value:function(){var e=this.URL;return q.a.get("".concat(e,"/movies"),{}).then((function(e){return e.data}))}},{key:"getGenres",value:function(){var e=this.URL;return q.a.get("".concat(e,"/genres"),{}).then((function(e){return e.data.sort((function(e,t){return e.name.localeCompare(t.name)})),e.data}))}},{key:"deleteRecord",value:function(e){var t=this.URL;return q.a.post("".concat(t,"/delete"),{apiKey:V,id:e}).then((function(e){return e.data}))}},{key:"addRecord",value:function(e){var t=this.URL;return Array.isArray(e.genreIds)&&(e.genreIds=JSON.stringify(e.genreIds)),e.apiKey=V,q.a.post("".concat(t,"/add"),e).then((function(e){return e.data}))}},{key:"updateRecord",value:function(e,t){for(var a=this.URL,n=0,r=["name","imdb_score","popularity","genreIds","director"];n<r.length;n++){var i=r[n];void 0===t[i]&&(t[i]="NULL")}return t.id=e,"NULL"!==t.genreIds&&(t.genreIds=JSON.stringify(t.genreIds)),t.apiKey=V,q.a.post("".concat(a,"/update"),t).then((function(e){return e.data}))}},{key:"verifyCredentials",value:function(e){var t=e.username,a=e.password,n=this.URL;return q.a.post("".concat(n,"/credentials"),{username:t,password:a}).then((function(e){return e.data}))}},{key:"addGenre",value:function(e){var t=this.URL;return e&&""!==e?q.a.post("".concat(t,"/addgenre"),{genre:e,apiKey:V}).then((function(e){return e.data})):new Promise((function(e,t){t("invalid genre: cannot be empty")}))}}]),e}();var z=function(e){Object(f.a)(a,e);var t=Object(v.a)(a);function a(e){var n;Object(m.a)(this,a),(n=t.call(this,e)).state={chipsFilters:[],searchFilter:"",data:[],verified:!1,genres:[]};return n.chipClicked=n.chipClicked.bind(Object(h.a)(n)),n.filterChanged=n.filterChanged.bind(Object(h.a)(n)),n.onPasswordSubmit=n.onPasswordSubmit.bind(Object(h.a)(n)),n.onSearch=function(e,t,a){var n;return function(){var r=this,i=arguments,o=function(){n=null,a||e.apply(r,i)},l=a&&!n;clearTimeout(n),n=setTimeout(o,t),l&&e.apply(r,i)}}(n.onSearch,400),n.onSearch=n.onSearch.bind(Object(h.a)(n)),n.onDataEdit=n.onDataEdit.bind(Object(h.a)(n)),n.onGenreSubmit=n.onGenreSubmit.bind(Object(h.a)(n)),n}return Object(p.a)(a,[{key:"componentDidMount",value:function(){var e=new W,t=this;Promise.all([e.getData(),e.getGenres()]).then((function(e){var a=Object(u.a)(e,2),n=a[0],r=a[1];t.originalData=n.slice(),t.setState({data:n,chipsFilters:r.map((function(e){return{value:e.name,applied:!1,key:e.id}})),genres:r})}))}},{key:"render",value:function(){return r.a.createElement("div",{className:"main-screen"},r.a.createElement(J,{chipClicked:this.chipClicked,chipsFilters:this.state.chipsFilters,onSearch:this.onSearch,isAdmin:this.props.isAdmin,onPasswordSubmit:this.onPasswordSubmit,verified:this.state.verified,onDataEdit:this.onDataEdit,onGenreSubmit:this.onGenreSubmit}),r.a.createElement(R,{data:this.state.data,isAdmin:this.props.isAdmin,verified:this.state.verified,genres:this.state.genres,onDataEdit:this.onDataEdit}))}},{key:"chipClicked",value:function(e){var t,a=this.state.chipsFilters.slice(),n=Object(d.a)(a);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.value===e.value){r.applied=!r.applied;break}}}catch(i){n.e(i)}finally{n.f()}this.setState({chipsFilters:a})}},{key:"onSearch",value:function(e,t){var a=t;this.setState({searchFilter:a})}},{key:"filterChanged",value:function(){var e=this.originalData.slice(),t=this.state,a=t.searchFilter,n=t.chipsFilters.filter((function(e){return e.applied}));e=e.filter((function(e){return e.name.toLowerCase().includes(a.toLowerCase())||e.director.toLowerCase().includes(a.toLowerCase())})),n.length>0&&(e=e.filter((function(e){var t,a=Object(d.a)(n);try{for(a.s();!(t=a.n()).done;){var r=t.value;if(!e.genres.includes(r.value))return!1}}catch(i){a.e(i)}finally{a.f()}return!0}))),this.setState({data:e})}},{key:"onPasswordSubmit",value:function(e,t){var a=this;console.log("username: "+e+" password: "+t),(new W).verifyCredentials({username:e,password:t}).then((function(e){e.valid&&a.setState({verified:!0})}))}},{key:"componentDidUpdate",value:function(e,t){t.searchFilter===this.state.searchFilter&&t.chipsFilters===this.state.chipsFilters||this.filterChanged()}},{key:"onDataEdit",value:function(e){var t=this,a=e.added,n=e.changed,r=e.deleted;console.log(e);var i=new W;if(r&&Array.isArray(r)&&r.length>0){r.forEach((function(e){i.deleteRecord(e)}));var o=new Set(r),l=this.originalData.filter((function(e){return!o.has(e.id)}));this.originalData=l.slice(),l=this.runThroughFilters(l),this.setState({data:l}),console.log("record deleted: IDs: ".concat(JSON.stringify(r)))}if(a){var s,c=Object(d.a)(a);try{for(c.s();!(s=c.n()).done;){var u=s.value;this.validate(u)?(this.mapGernesToIds(u),i.addRecord(u).then((function(e){var a=e.movieId,n=(e.added,a);u.id=n;var r=t.originalData.concat(u);t.originalData=r.slice(),r=t.runThroughFilters(r),t.setState({data:r}),console.log("record added; ID: ".concat(n))}))):console.log("invalid")}}catch(v){c.e(v)}finally{c.f()}}if(n)for(var m=function(){f=h[p];var e=parseInt(f);u=n[e],t.validateChanged(u)?(t.mapGernesToIds(u),i.updateRecord(e,u).then((function(a){a.name=a.movie_name,delete a.movie_name,t.mapIdstoGenres(a);for(var n=t.originalData.slice(),r=0;r<t.originalData.length;r++){var i=t.originalData[r];if(e===i.id){n[r]=a;break}}t.originalData=n.slice(),n=t.runThroughFilters(n),t.setState({data:n}),console.log("record changed; ID: ".concat(e))}))):console.log("invalid")},p=0,h=Object.keys(n);p<h.length;p++){var f;m()}}},{key:"validate",value:function(e){return!["name","director","genres","imdb_score","popularity"].some((function(t){return void 0===e[t]}))&&(!(!Array.isArray(e.genres)||0===e.genres.length)&&(!isNaN(parseFloat(e.popularity))&&!isNaN(parseFloat(e.imdb_score))))}},{key:"validateChanged",value:function(e){if(void 0!==e.name&&""===e.name)return!1;if(void 0!==e.director&&""===e.director)return!1;if(void 0!==e.genres&&(!Array.isArray(e.genres)||0===e.genres.length))return!1;if(void 0!==e.popularity){if(""===e.popularity)return!1;if(isNaN(parseFloat(e.popularity)))return!1}if(void 0!==e.imdb_score){if(""===e.imdb_score)return!1;if(isNaN(parseFloat(e.imdb_score)))return!1}return!0}},{key:"runThroughFilters",value:function(e){Object(c.a)(e);var t=this.state,a=t.chipsFilters,n=t.searchFilter,r=new Set;return a.forEach((function(e){e.applied&&r.add(e.value)})),r.size>0&&(e=e.filter((function(e){return Array.isArray(e.genre)?e.genre.some((function(e){return r.has(e)})):e.genres.some((function(e){return r.has(e)}))}))),e=e.filter((function(e){return e.name.includes(n)||e.director.includes(n)}))}},{key:"onGenreSubmit",value:function(e){var t,a=this,n=new W,r=this,i=Object(d.a)(this.state.chipsFilters);try{for(i.s();!(t=i.n()).done;){if(t.value.value===e)return void Q.showError("genre already exists")}}catch(o){i.e(o)}finally{i.f()}n.addGenre(e).then((function(t){console.log(t);var n=a.state.chipsFilters.slice();n.push({applied:!1,value:e,key:t.genreId}),r.setState({chipsFilters:n})}))}},{key:"mapGernesToIds",value:function(e){var t,a={},n=Object(d.a)(this.state.chipsFilters);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=r.value,o=r.key;a[i]=o}}catch(l){n.e(l)}finally{n.f()}e.genres&&(e.genreIds=e.genres.map((function(e){return a[e]})))}},{key:"mapIdstoGenres",value:function(e){var t,a={},n=Object(d.a)(this.state.chipsFilters);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=r.value,o=r.key;a[o]=i}}catch(l){n.e(l)}finally{n.f()}e.genre_ids&&(e.genre_ids=JSON.parse(e.genre_ids),e.genres=e.genre_ids.map((function(e){return a[e]})))}}]),a}(r.a.Component);var $=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(l.a,null,r.a.createElement("div",null,r.a.createElement(s.c,null,r.a.createElement(s.a,{path:"/admin"},r.a.createElement(z,{isAdmin:!0})),r.a.createElement(s.a,{path:"/"},r.a.createElement(z,{isAdmin:!1}))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement($,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[125,1,2]]]);
//# sourceMappingURL=main.b2f3de8e.chunk.js.map